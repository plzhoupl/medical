function loginFn(e,n,t){var i=$(".commonError"),o=$("#redirect").val();$(e).addClass("submitBtn-grey"),i.hide(),$.ajax({url:n,data:t,type:"POST",dataType:"json",success:function(n){0==n.code?(window.ActiveXObject||"ActiveXObject"in window||document.write(n.loginurl),window.location.href=""!=o?decodeURIComponent(o):"/"):(i.show().text(n.message),$(e).removeClass("submitBtn-grey"),veryFn.closeError(i))},error:function(){i.show().text("网络异常"),$(e).removeClass("submitBtn-grey"),veryFn.closeError(i)}})}
function registerFn(e,n,t){var i=$(".commonError"),o=$("#redirect").val();$(e).addClass("submitBtn-grey"),i.hide(),$.ajax({url:"",data:n,type:"POST",dataType:"json",success:function(n){0==n.code?t&&""!=t?window.location.href=""+t:window.location.href=""!=o?decodeURIComponent(o):"/":(i.show().text(n.message),$(e).removeClass("submitBtn-grey"),veryFn.closeError(i))},error:function(){i.show().text("网络异常"),$(e).removeClass("submitBtn-grey"),veryFn.closeError(i)}})}
$.extend({maskingFn:function(e){},removeMaskingFn:function(e){}}),$.fn.extend({middleFn:function(){var e;"undefined"!=typeof window.pageYOffset?e=window.pageYOffset:"undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?e=document.documentElement.scrollTop:"undefined"!=typeof document.body&&(e=document.body.scrollTop),$(this).css({top:"50%","margin-top":-($(this).height()/2),left:"50%","margin-left":-($(this).width()/2)})},closeFn:function(){$.removeMaskingFn(),$(this).hide()}})
var local_url=window.location.href,token=$("#token").val();-1!=local_url.indexOf("regUrl")&&($(".tab-title a").removeClass("active").eq(1).addClass("active"),$(".con-box").hide(),$(".reg-conbox").show()),$(".tab-title a").click(function(){var e=$(this),n=e.attr("tab");e.index();e.addClass("active").siblings().removeClass("active"),$(".con-box").hide(),$("."+n+"-conbox").show()}),$("#agreeTiao").click(function(){var e=$(this),n=$(".regBtn");e.hasClass("active")?(e.removeClass("active"),n.addClass("submitBtn-grey")):(e.addClass("active"),n.removeClass("submitBtn-grey"))}),$(".userAgree").click(function(){var e=$(this).attr("tab");$("#userXieyiDialog").show().middleFn(),$.maskingFn(),$("#userXieyiDialog .title").hide(),$("#userXieyiDialog .c").hide(),$("#userXieyiDialog ."+e).show(),$("html").css({height:"100%",overflow:"hidden","padding-right":"17px"})}),$("#userXieyiDialog b, #userXieyiDialog .tijiao").click(function(){$("#userXieyiDialog").closeFn(),$("html").css({height:"auto",overflow:"auto",padding:"0"})}),$(".changeLink").click(function(){var e=$(this).attr("tab");$("."+e).show().siblings().hide(),$("."+e).find(".error").hide(),$("."+e).find(".l-input").removeClass("e-input")}),$(function(){$(".l-input").focus(function(){$(this).closest("li").find(".error").hide(),$(this).removeClass("e-input")}),$("#nameLogin").blur(function(){veryFn.userIndenty($(this))}),$("#psdLogin").blur(function(){veryFn.psdIndenty($(this))}),$("#mobileLog").blur(function(){veryFn.mobileIndenty($(this))}),$("#codeLog").blur(function(){veryFn.sendCodeIndenty($(this))}),$("#emailReg").blur(function(){veryFn.emailIndenty($(this))}),$("#mobileReg").blur(function(){veryFn.mobileIndenty($(this),!0)}),$("#codeReg").blur(function(){veryFn.sendCodeIndenty($(this))}),$(".psdreg").blur(function(){veryFn.psdIndenty($(this),!0)}),$(".psdconreg").blur(function(){veryFn.psdConfirmIndenty($(this))})}),$("#sendCodeLog").click(function(){var e,n=$(".commonError");!$(this).hasClass("noSendCode")&&veryFn.mobileIndenty("#mobileLog")&&(e={_token:token,mobileauthcode:$.trim($("#mobileLog").val())},$.commonSendCode($(this),e,n,"smslogin"))}),$("#sendCode").click(function(){if(!$(this).hasClass("noSendCode")&&veryFn.mobileIndenty("#mobileReg")){var e="",n=$(".commonError"),t={_token:token,mobile_number:$.trim($("#mobileReg").val())};$.commonSendCode($(this),t,n,"reg",e)}}),$("#logUserBtn").click(function(){if(!$(this).hasClass("submitBtn-grey")){veryFn.userIndenty("#nameLogin"),veryFn.psdIndenty("#psdLogin");var e=$.trim($("#nameLogin").val()),n=$.trim($("#psdLogin").val()),t="/account/newAjaxlogin",i={};0==$(".user-login .error:visible").length&&(i={_token:token,name:e,password:n},loginFn(this,t,i))}}),$("#logMobileBtn").click(function(){if(!$(this).hasClass("submitBtn-grey")){veryFn.mobileIndenty("#mobileLog"),veryFn.sendCodeIndenty("#codeLog");var e=$.trim($("#mobileLog").val()),n=$.trim($("#codeLog").val()),t="/account/smscodelogin",i={};0==$(".mobile-login .error:visible").length&&(i={_token:token,mobile_number:e,mobileauthcode:n},loginFn(this,t,i))}}),$("#regMobileBtn").click(function(){if(!$(this).hasClass("submitBtn-grey")){veryFn.mobileIndenty("#mobileReg",!0),veryFn.sendCodeIndenty("#codeReg"),veryFn.psdIndenty("#psdMReg",!0),veryFn.psdConfirmIndenty("#psdMConfirmReg");var e=$.trim($("#mobileReg").val()),n=$.trim($("#codeReg").val()),t=$.trim($("#psdMReg").val()),i={};0==$(".mobile-reg .error:visible").length&&(i={_token:token,type:1,password:t,password_confirmation:t,mobile_number:e,mobileauthcode:n,email:""},registerFn(this,i))}}),$("#regEmailBtn").click(function(){if(!$(this).hasClass("submitBtn-grey")){veryFn.emailIndenty("#emailReg"),veryFn.psdIndenty("#psdEReg",!0),veryFn.psdConfirmIndenty("#psdEConfirmReg");var e=$.trim($("#emailReg").val()),n=$.trim($("#psdEReg").val()),t={};0==$(".email-reg .error:visible").length&&(t={_token:token,type:2,password:n,password_confirmation:n,mobile_number:"",mobileauthcode:"",email:e},registerFn(this,t,e))}}),$("body").bind("keyup",function(e){var n=e||window.event,t=n.keyCode||n.which||n.charCode;"13"==t&&($(".login-conbox:visible").length>0&&($(".user-login:visible").length>0?$("#logUserBtn").click():$(".mobile-login:visible").length>0&&$("#logMobileBtn").click()),$(".reg-conbox:visible").length>0&&($(".mobile-reg:visible").length>0?$("#regMobileBtn").click():$(".email-reg:visible").length>0&&$("#regEmailBtn").click()))});var veryFn={empty:function(e){return""===e},mobile:function(e){var n=/^1[34578][0-9]\d{8}$/;return n.test(e)},email:function(e){var n=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9_\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return n.test(e)},tIndenty:function(e,n,t,i){var o=$.trim($(e).val()),r=$(e).closest("li").find(".error");return veryFn.empty(o)?(r.show().text(n),!1):$.wordLength(o)<t||$.wordLength(o)>i?(r.show().text("请输入"+t+"-"+i+"个字"),!1):!0},userIndenty:function(e){var n=$.trim($(e).val()),t=$(e).closest("li").find(".error");return veryFn.empty(n)?(t.show().text("请输入账号"),$(e).addClass("e-input"),!1):n.length<2||n.length>32?(t.show().text("请输入2-32位的账号"),$(e).addClass("e-input"),!1):!0},mobileIndenty:function(e,n){var t=$.trim($(e).val()),i=$(e).closest("li").find(".error");return veryFn.empty(t)?(i.show().text("请输入手机号码"),$(e).addClass("e-input"),!1):veryFn.mobile(t)?n?void $.ajax({url:""+t,type:"GET",async:!1,dataType:"json",success:function(n){return 0==n.code?($(e).removeClass("e-input"),!0):($(e).addClass("e-input"),i.show().html(n.message),!1)}}):($(e).removeClass("e-input"),!0):(i.show().text("请输入正确的手机号"),$(e).addClass("e-input"),!1)},sendCodeIndenty:function(e){var n=$.trim($(e).val()),t=$(e).closest("li").find(".error");return veryFn.empty(n)?(t.show().text("请输入验证码"),$(e).addClass("e-input"),!1):($(e).removeClass("e-input"),!0)},emailOrMobile:function(e){var n=$.trim($(e).val()),t=$(e).parent().find(".error");if(veryFn.empty(n))return t.show().text("请输入邮箱或手机号"),$(e).addClass("e-input"),!1;if(!veryFn.email(n)&&!veryFn.mobile(n))return t.show().text("邮箱或手机号错误"),$(e).addClass("e-input"),!1;if(veryFn.email(n)){if(n.length>32)return t.show().text("邮箱必须小于32个字符"),$(e).addClass("e-input"),!1;$.ajax({url:""+n,type:"GET",async:!1,dataType:"json",success:function(n){return 0==n.status?(t.show().html("该邮箱不存在"),$(e).addClass("e-input"),!1):($(e).removeClass("e-input"),!0)}})}
    veryFn.mobile(n)&&$.ajax({url:""+n,type:"GET",async:!1,dataType:"json",success:function(n){return 0==n.status?($(e).addClass("e-input"),t.show().html(n.message),!1):($(e).removeClass("e-input"),!0)}})},emailIndenty:function(e){var n=$.trim($(e).val()),t=$(e).parent().find(".error");return veryFn.empty(n)?(t.show().text("请输入邮箱"),$(e).addClass("e-input"),!1):veryFn.email(n)?n.length>32?(t.show().text("邮箱必须小于32个字符"),$(e).addClass("e-input"),!1):void $.ajax({url:""+n,type:"GET",async:!1,dataType:"json",success:function(n){return 0==n.code?($(e).removeClass("e-input"),!0):(t.show().html("该邮箱已存在"),$(e).addClass("e-input"),!1)}}):(t.show().text("邮箱错误"),$(e).addClass("e-input"),!1)},psdIndenty:function(e,n){var t=$.trim($(e).val()),i=$(e).parent().find(".error"),o=t.length;return veryFn.empty(t)?(i.show().text("请输入密码"),$(e).addClass("e-input"),!1):n&&(6>o||o>12)?(i.show().text("请输入6-12位的密码"),$(e).addClass("e-input"),!1):($(e).removeClass("e-input"),!0)},psdConfirmIndenty:function(e){var n=$.trim($(e).val()),t=$(e).parent().find(".error"),i=(n.length,$.trim($(e).closest("ul").find(".psdreg").val()));return veryFn.empty(n)?(t.show().text("请输入确认密码"),$(e).addClass("e-input"),!1):n!=i?(t.show().text("确认密码不正确"),$(e).addClass("e-input"),!1):($(e).removeClass("e-input"),!0)},idCardIndenty:function(e){var n=$.trim($(e).val()),t=$(e).closest("li").find(".error");return veryFn.empty(n)?(t.show().text(errorInfo.icNull),!1):$.IdentityIdCard(n)?!0:(t.show().text(errorInfo.icError),!1)},isNum:function(e,n,t){return isNaN(e)?!1:!(n>e||e>t)},scrollObj:function(e){var n=$(e).offset().top;$("html, body").animate({scrollTop:n},300)},dialogNotice:function(e){$("#dialog-wait").show().middleFn(),$("#dialog-wait .c").text(e),$.maskingFn();var n="";$("#dialog-wait b").click(function(){clearTimeout(n),$("#dialog-wait").closeFn()}),n=setTimeout(function(){$("#dialog-wait").closeFn()},1e3)},closeError:function(e){setTimeout(function(){$(e).hide()},2e3)}};